// [1page]==================================
// [[문제1]
SELECT
TO_CHAR(hire_date,'MM')||'월' 월, count(*) 직원수
FROM employees
GROUP BY TO_CHAR(hire_date,'MM')
ORDER BY 월;


// [[문제2]

SELECT
d.department_name, e.first_name, e.salary
FROM employees e, departments d, (SELECT
								  max(salary) maxsal, department_id
								  FROM employees
								  GROUP BY department_id) vt
WHERE e.department_id = d.department_id AND
      e.department_id = vt.department_id AND
      e.salary = vt.maxsal;

//부서별 maxsalary
SELECT
max(salary) maxsal, department_id
FROM employees
GROUP BY department_id;


// [[문제3]
SELECT
d.department_name 부서명, max(salary) 최대급여, min(salary) 최소급여, ROUND(avg(salary)) 평균급여
FROM employees e, departments d
WHERE d.department_id = e.department_id
GROUP BY d.department_name
HAVING ROUND(avg(salary)) > (SELECT
							 ROUND(avg(salary)) ITAVG
							 FROM employees e, departments d
							 WHERE d.department_id = e.department_id
							 GROUP BY d.department_name
							 HAVING d.department_name IN 'IT') AND
		ROUND(avg(salary)) < (SELECT
							  ROUND(avg(salary)) SalesAVG
							  FROM employees e, departments d
							  WHERE d.department_id = e.department_id
							  GROUP BY d.department_name
							  HAVING d.department_name IN 'Sales');


SELECT
ROUND(avg(salary)) ITAVG
FROM employees e, departments d
WHERE d.department_id = e.department_id
GROUP BY d.department_name
HAVING d.department_name IN 'IT';

SELECT
ROUND(avg(salary)) SalesAVG
FROM employees e, departments d
WHERE d.department_id = e.department_id
GROUP BY d.department_name
HAVING d.department_name IN 'Sales';


// [[문제4]
SELECT
NVL(d.department_name,'<신생부서>') 부서명, COUNT(*) 직원수
FROM departments d, employees e
WHERE e.department_id = d.department_id(+)
GROUP BY d.department_name
HAVING COUNT(*) = 1
ORDER BY 부서명 DESC;


//[2page]==================================
// [문제1]
SELECT
d.department_name 부서명, TO_CHAR(e.hire_date,'MM') 입사월, COUNT(*) 직원수
FROM employees e, departments d
WHERE d.department_id = e.department_id
GROUP BY d.department_name, TO_CHAR(e.hire_date,'MM')
HAVING COUNT(*) > 4
ORDER BY 부서명;

// [문제2]
SELECT
NVL(c.country_name,'<부서없음>') 국가명, NVL(l.city,'<부서없음>') 도시명,count(*) 직원수
FROM employees e, departments d, locations l, countries c
WHERE e.department_id = d.department_id(+) AND
	  d.location_id = l.location_id(+) AND
	  l.country_id = c.country_id(+)
GROUP BY c.country_name, l.city;

// [문제3]
SELECT
employee_id 직원아이디, first_name 이름, salary 급여, avg(salary)
FROM employees
GROUP BY employee_id, first_name, salary;

//최대급여
SELECT
e.employee_id, max(e.salary)
FROM employees e, departments
GROUP BY employee_id;

// [문제4]
