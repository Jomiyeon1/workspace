// [ 문제  1 ]

select
e.employee_id 사번, e.department_id 부서번호, e.salary 연봉, vt.avgsal 부서평균연봉 
from employees e,
(select
department_id, round(avg(salary),0) avgsal
from employees 
group by department_id) vt
where (e.department_id = vt.department_id) and (e.salary > vt.avgsal)
order by 부서평균연봉 DESC;


//부서별평균연봉조회
select
department_id, round(avg(salary),0) 부서평균연봉 
from employees 
group by department_id;

// [ 문제  2 ]
select
rank() over (partition by salary order by salary desc) rank, last_name 이름
from employees;


// [ 문제  3 ]

// [ 문제  4 ]
select
e.last_name 사원이름, e.manager_id 매니저이름, department_id  부서이름
from countries c, employees e
where e.country_id = c.country_id ;

order by e.last_name;
c.country_name = 'seattle'
//============================문제4
//seattle인 사람 출력
select
e.last_name, d.department_id
from employees e, departments d
where e.department_id between 90 and 270;


